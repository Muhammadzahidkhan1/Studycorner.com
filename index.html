
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAK-MED STUDY CORNER MDCAT</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Slab:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        /* ========== RESET & BASE STYLES ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a237e;
            --secondary: #00bcd4;
            --accent: #ff4081;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --dark: #0d1b2a;
            --light: #f8f9fa;
            --border: #e2e8f0;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
            --radius: 10px;
            --transition: all 0.3s ease;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .hidden {
            display: none !important;
        }

        /* ========== NAVIGATION ========== */
        .navbar {
            background: white;
            box-shadow: var(--shadow);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 1rem 0;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .logo i {
            font-size: 2rem;
            color: var(--secondary);
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .nav-link {
            text-decoration: none;
            color: var(--text);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 5px;
            transition: var(--transition);
        }

        .nav-link:hover,
        .nav-link.active {
            background: rgba(0, 188, 212, 0.1);
            color: var(--secondary);
        }

        .auth-buttons {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--secondary);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--secondary);
            color: var(--secondary);
        }

        /* ========== HOMEPAGE ========== */
        #home-page {
            padding-top: 80px;
        }

        .hero {
            padding: 4rem 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        /* ========== AUTH PAGES ========== */
        .auth-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 2rem;
        }

        .auth-box {
            background: white;
            border-radius: var(--radius);
            padding: 3rem;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .auth-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border);
            padding-bottom: 1rem;
        }

        .auth-tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: var(--text);
            border-radius: 5px;
        }

        .auth-tab.active {
            background: var(--secondary);
            color: white;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
        }

        .social-login {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .social-btn {
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            transition: var(--transition);
        }

        /* ========== DASHBOARD ========== */
        #dashboard-page {
            padding-top: 80px;
            min-height: 100vh;
        }

        .dashboard-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 2rem;
            padding: 2rem 0;
        }

        .user-profile {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border);
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            margin: 0 auto 1rem;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            font-weight: 700;
        }

        /* ========== TESTS PAGE ========== */
        .tests-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            padding: 2rem 0;
        }

        .test-card {
            background: white;
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: var(--transition);
        }

        .test-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        /* ========== QUIZ PAGE ========== */
        .quiz-container {
            max-width: 800px;
            margin: 2rem auto;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        /* ========== ADMIN PAGE ========== */
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .dashboard-container {
                grid-template-columns: 1fr;
            }
            
            .social-login {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-container">
                <div class="logo" onclick="showPage('home')">
                    <i class="fas fa-stethoscope"></i>
                    <h1>PAK-MED STUDY CORNER</h1>
                </div>
                
                <div class="nav-links">
                    <a class="nav-link active" onclick="showPage('home')">
                        <i class="fas fa-home"></i> Home
                    </a>
                    <a class="nav-link" onclick="showPage('tests')">
                        <i class="fas fa-file-alt"></i> Tests
                    </a>
                    <a class="nav-link" onclick="showPage('subjects')">
                        <i class="fas fa-book"></i> Subjects
                    </a>
                    <a class="nav-link" onclick="showPage('dashboard')">
                        <i class="fas fa-user"></i> Dashboard
                    </a>
                </div>
                
                <div class="auth-buttons">
                    <button class="btn btn-outline" onclick="showPage('login')">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <button class="btn btn-primary" onclick="showPage('login')">
                        <i class="fas fa-user-plus"></i> Sign Up
                    </button>
                </div>
                
                <div class="mobile-menu-btn" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars"></i>
                </div>
            </div>
        </div>
    </nav>

    <!-- ========== HOMEPAGE ========== -->
    <div id="home-page" class="page">
        <section class="hero">
            <div class="container">
                <h1>MDCAT Preparation Platform</h1>
                <p>Complete study materials and practice tests</p>
            </div>
        </section>
    </div>

    <!-- ========== LOGIN/REGISTER PAGE ========== -->
    <div id="login-page" class="page hidden">
        <div class="auth-page">
            <div class="auth-box">
                <div class="auth-tabs">
                    <div class="auth-tab active" onclick="switchAuthTab('login')">Login</div>
                    <div class="auth-tab" onclick="switchAuthTab('register')">Register</div>
                </div>
                
                <!-- Login Form -->
                <div id="login-form">
                    <div class="form-group">
                        <input type="email" class="form-control" id="login-email" placeholder="Email Address">
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-control" id="login-password" placeholder="Password">
                    </div>
                    <button class="btn btn-primary w-100" onclick="handleLogin()">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    
                    <div style="margin: 2rem 0; text-align: center; color: #666;">
                        OR CONTINUE WITH
                    </div>
                    
                    <div class="social-login">
                        <button class="social-btn" onclick="loginWithFacebook()">
                            <i class="fab fa-facebook"></i> Facebook
                        </button>
                        <button class="social-btn" onclick="loginWithGoogle()">
                            <i class="fab fa-google"></i> Google
                        </button>
                    </div>
                    
                    <div class="phone-login" style="margin-top: 1.5rem;">
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                            <select class="form-control" style="flex: 0 0 100px;">
                                <option>+92</option>
                                <option>+1</option>
                                <option>+44</option>
                            </select>
                            <input type="tel" class="form-control" placeholder="Phone Number">
                        </div>
                        <button class="btn btn-outline w-100" onclick="loginWithPhone()">
                            <i class="fas fa-mobile-alt"></i> Send OTP
                        </button>
                    </div>
                </div>
                
                <!-- Register Form -->
                <div id="register-form" class="hidden">
                    <div class="form-group">
                        <input type="text" class="form-control" id="reg-name" placeholder="Full Name">
                    </div>
                    <div class="form-group">
                        <input type="email" class="form-control" id="reg-email" placeholder="Email Address">
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-control" id="reg-password" placeholder="Password">
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-control" id="reg-confirm" placeholder="Confirm Password">
                    </div>
                    <button class="btn btn-primary w-100" onclick="handleRegister()">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== DASHBOARD ========== -->
    <div id="dashboard-page" class="page hidden">
        <div class="container">
            <div class="dashboard-container">
                <div class="sidebar">
                    <div class="user-profile">
                        <div class="user-avatar" id="user-avatar">U</div>
                        <h3 id="user-name">User Name</h3>
                        <p id="user-email">user@example.com</p>
                    </div>
                    
                    <div style="margin-bottom: 2rem;">
                        <h4 style="margin-bottom: 1rem;">My Progress</h4>
                        <div id="progress-stats">
                            <!-- Progress will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <div class="main-content">
                    <h2>Welcome Back!</h2>
                    <p>Your personalized dashboard</p>
                    
                    <div class="stats-grid" id="user-stats">
                        <!-- User stats will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== TESTS PAGE ========== -->
    <div id="tests-page" class="page hidden">
        <div class="container">
            <h2 style="margin-top: 100px; margin-bottom: 2rem;">Practice Tests</h2>
            
            <div style="display: flex; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap;">
                <button class="btn" onclick="filterTests('all')" id="filter-all">All Tests</button>
                <button class="btn" onclick="filterTests('biology')" id="filter-bio">Biology</button>
                <button class="btn" onclick="filterTests('chemistry')" id="filter-chem">Chemistry</button>
                <button class="btn" onclick="filterTests('physics')" id="filter-phy">Physics</button>
                <button class="btn" onclick="filterTests('english')" id="filter-eng">English</button>
            </div>
            
            <div class="tests-grid" id="tests-container">
                <!-- Tests will be loaded dynamically -->
            </div>
        </div>
    </div>

    <!-- ========== QUIZ PAGE ========== -->
    <div id="quiz-page" class="page hidden">
        <div class="quiz-container">
            <div id="quiz-content">
                <!-- Quiz content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- ========== ADMIN PAGE ========== -->
    <div id="admin-page" class="page hidden">
        <div class="container">
            <div style="padding-top: 100px;">
                <h1>Admin Dashboard</h1>
                
                <div class="admin-stats">
                    <div style="background: #667eea; color: white; padding: 2rem; border-radius: 10px;">
                        <h3 id="total-users">0</h3>
                        <p>Total Users</p>
                    </div>
                    <div style="background: #00bcd4; color: white; padding: 2rem; border-radius: 10px;">
                        <h3 id="online-users">0</h3>
                        <p>Online Now</p>
                    </div>
                    <div style="background: #4caf50; color: white; padding: 2rem; border-radius: 10px;">
                        <h3 id="active-users">0</h3>
                        <p>Active Today</p>
                    </div>
                </div>
                
                <div style="background: white; padding: 2rem; border-radius: 10px; margin-top: 2rem;">
                    <h3>All Users</h3>
                    <div id="users-list">
                        <!-- Users will be listed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== JavaScript ========== -->
    <script>
        // ========== APPLICATION STATE ==========
        const appState = {
            currentUser: null,
            isLoggedIn: false,
            isAdmin: false,
            users: JSON.parse(localStorage.getItem('mdcatUsers')) || [
                {
                    id: 1,
                    name: 'Admin',
                    email: 'doctormotivation29@gmail.com',
                    password: 'Admin@123',
                    role: 'admin',
                    progress: {}
                }
            ],
            currentTest: null,
            currentQuestion: 0,
            userAnswers: [],
            userProgress: {},
            onlineUsers: []
        };

        // ========== DIFFERENT TEST QUESTIONS ==========
        const testQuestions = {
            biology: [
                {
                    question: "What is the powerhouse of the cell?",
                    options: ["Nucleus", "Mitochondria", "Ribosome", "Golgi Apparatus"],
                    correct: 1
                },
                {
                    question: "Which process produces ATP?",
                    options: ["Photosynthesis", "Cellular Respiration", "Mitosis", "Meiosis"],
                    correct: 1
                },
                {
                    question: "What is the function of ribosomes?",
                    options: ["Energy production", "Protein synthesis", "Cell division", "Waste removal"],
                    correct: 1
                }
            ],
            chemistry: [
                {
                    question: "What is the atomic number of Hydrogen?",
                    options: ["1", "2", "6", "8"],
                    correct: 0
                },
                {
                    question: "Which element is a noble gas?",
                    options: ["Oxygen", "Nitrogen", "Helium", "Carbon"],
                    correct: 2
                },
                {
                    question: "What is the pH of pure water?",
                    options: ["5", "7", "8", "14"],
                    correct: 1
                }
            ],
            physics: [
                {
                    question: "What is the SI unit of force?",
                    options: ["Joule", "Watt", "Newton", "Pascal"],
                    correct: 2
                },
                {
                    question: "Who discovered gravity?",
                    options: ["Einstein", "Newton", "Galileo", "Tesla"],
                    correct: 1
                },
                {
                    question: "What is the speed of light?",
                    options: ["3x10^5 m/s", "3x10^8 m/s", "3x10^3 m/s", "3x10^10 m/s"],
                    correct: 1
                }
            ],
            english: [
                {
                    question: "What is a synonym for 'happy'?",
                    options: ["Sad", "Angry", "Joyful", "Tired"],
                    correct: 2
                },
                {
                    question: "Which is a preposition?",
                    options: ["Run", "Beautiful", "In", "Quickly"],
                    correct: 2
                },
                {
                    question: "Past tense of 'go' is:",
                    options: ["Goed", "Went", "Gone", "Going"],
                    correct: 1
                }
            ]
        };

        // ========== INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is already logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                const user = JSON.parse(savedUser);
                appState.currentUser = user;
                appState.isLoggedIn = true;
                appState.isAdmin = user.role === 'admin';
                
                // Mark user as online
                if (!appState.onlineUsers.includes(user.id)) {
                    appState.onlineUsers.push(user.id);
                }
            }
            
            // Load initial page
            const hash = window.location.hash.substring(1);
            if (hash) {
                showPage(hash);
            }
        });

        // ========== PAGE NAVIGATION ==========
        function showPage(page) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(el => {
                el.classList.add('hidden');
            });
            
            // Update navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show requested page
            const pageElement = document.getElementById(`${page}-page`);
            if (pageElement) {
                pageElement.classList.remove('hidden');
                
                // Update navigation for main pages
                if (['home', 'tests', 'subjects', 'dashboard'].includes(page)) {
                    document.querySelector(`[onclick="showPage('${page}')"]`)?.classList.add('active');
                }
                
                // Initialize page content
                switch(page) {
                    case 'home':
                        break;
                    case 'login':
                        switchAuthTab('login');
                        break;
                    case 'tests':
                        loadTestsPage();
                        break;
                    case 'dashboard':
                        if (!appState.isLoggedIn) {
                            showPage('login');
                            return;
                        }
                        loadDashboard();
                        break;
                    case 'admin':
                        if (!appState.isAdmin) {
                            showPage('home');
                            return;
                        }
                        loadAdminDashboard();
                        break;
                }
            }
        }

        // ========== AUTHENTICATION ==========
        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => {
                t.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.getElementById('login-form').classList.toggle('hidden', tab !== 'login');
            document.getElementById('register-form').classList.toggle('hidden', tab !== 'register');
        }

        function handleRegister() {
            const name = document.getElementById('reg-name').value;
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-password').value;
            const confirm = document.getElementById('reg-confirm').value;
            
            // Validation
            if (!name || !email || !password || !confirm) {
                alert('Please fill all fields');
                return;
            }
            
            if (password !== confirm) {
                alert('Passwords do not match');
                return;
            }
            
            if (password.length < 6) {
                alert('Password must be at least 6 characters');
                return;
            }
            
            // Check if user already exists
            const existingUser = appState.users.find(u => u.email === email);
            if (existingUser) {
                alert('User already exists with this email');
                return;
            }
            
            // Create new user
            const newUser = {
                id: Date.now(),
                name: name,
                email: email,
                password: password,
                role: 'student',
                progress: {},
                joined: new Date().toISOString()
            };
            
            // Add to users array
            appState.users.push(newUser);
            localStorage.setItem('mdcatUsers', JSON.stringify(appState.users));
            
            // Auto login
            completeLogin(newUser, false);
            
            alert('Registration successful! Welcome ' + name);
        }

        function handleLogin() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            // Find user
            const user = appState.users.find(u => 
                u.email === email && u.password === password
            );
            
            if (!user) {
                alert('Invalid email or password');
                return;
            }
            
            completeLogin(user, user.role === 'admin');
        }

        function completeLogin(user, isAdmin) {
            appState.currentUser = user;
            appState.isLoggedIn = true;
            appState.isAdmin = isAdmin;
            
            // Mark as online
            if (!appState.onlineUsers.includes(user.id)) {
                appState.onlineUsers.push(user.id);
            }
            
            // Save to localStorage
            localStorage.setItem('currentUser', JSON.stringify(user));
            
            // Redirect to dashboard
            if (isAdmin) {
                showPage('admin');
            } else {
                showPage('dashboard');
            }
        }

        // ========== SOCIAL LOGIN ==========
        function loginWithFacebook() {
            // Simulate Facebook login flow
            const facebookWindow = window.open('', 'Facebook Login', 'width=600,height=400');
            
            // In real app, this would be actual Facebook login URL
            // For demo, simulate login
            setTimeout(() => {
                facebookWindow.close();
                
                // Create or find Facebook user
                let user = appState.users.find(u => u.email === 'facebook@user.com');
                
                if (!user) {
                    user = {
                        id: Date.now(),
                        name: 'Facebook User',
                        email: 'facebook@user.com',
                        role: 'student',
                        progress: {},
                        joined: new Date().toISOString()
                    };
                    appState.users.push(user);
                    localStorage.setItem('mdcatUsers', JSON.stringify(appState.users));
                }
                
                completeLogin(user, false);
                alert('Logged in with Facebook successfully!');
            }, 1500);
        }

        function loginWithGoogle() {
            // Simulate Google login flow
            const googleWindow = window.open('', 'Google Login', 'width=600,height=400');
            
            // In real app, this would redirect to Google OAuth
            setTimeout(() => {
                googleWindow.close();
                
                // Create or find Google user
                let user = appState.users.find(u => u.email === 'google@user.com');
                
                if (!user) {
                    user = {
                        id: Date.now(),
                        name: 'Google User',
                        email: 'google@user.com',
                        role: 'student',
                        progress: {},
                        joined: new Date().toISOString()
                    };
                    appState.users.push(user);
                    localStorage.setItem('mdcatUsers', JSON.stringify(appState.users));
                }
                
                completeLogin(user, false);
                alert('Logged in with Google successfully!');
            }, 1500);
        }

        function loginWithPhone() {
            const phoneNumber = document.querySelector('.phone-login input[type="tel"]').value;
            
            if (!phoneNumber) {
                alert('Please enter phone number');
                return;
            }
            
            // Simulate OTP sending
            const otp = Math.floor(1000 + Math.random() * 9000);
            
            // Show OTP input
            const phoneDiv = document.querySelector('.phone-login');
            phoneDiv.innerHTML = `
                <div style="text-align: center; margin-bottom: 1rem;">
                    <p>OTP sent to +92${phoneNumber}</p>
                    <p style="font-weight: bold; font-size: 1.5rem;">${otp}</p>
                </div>
                <input type="text" class="form-control" id="otp-input" placeholder="Enter OTP" style="margin-bottom: 1rem;">
                <button class="btn btn-primary w-100" onclick="verifyOTP(${otp}, '${phoneNumber}')">
                    <i class="fas fa-check"></i> Verify OTP
                </button>
            `;
        }

        function verifyOTP(otp, phoneNumber) {
            const enteredOTP = document.getElementById('otp-input').value;
            
            if (enteredOTP === otp.toString()) {
                // Create or find phone user
                let user = appState.users.find(u => u.email === `phone${phoneNumber}@user.com`);
                
                if (!user) {
                    user = {
                        id: Date.now(),
                        name: `Phone User ${phoneNumber.slice(-4)}`,
                        email: `phone${phoneNumber}@user.com`,
                        phone: phoneNumber,
                        role: 'student',
                        progress: {},
                        joined: new Date().toISOString()
                    };
                    appState.users.push(user);
                    localStorage.setItem('mdcatUsers', JSON.stringify(appState.users));
                }
                
                completeLogin(user, false);
                alert('Phone verification successful!');
            } else {
                alert('Invalid OTP. Please try again.');
            }
        }

        // ========== DASHBOARD ==========
        function loadDashboard() {
            if (!appState.currentUser) return;
            
            // Update user info
            document.getElementById('user-name').textContent = appState.currentUser.name;
            document.getElementById('user-email').textContent = appState.currentUser.email;
            document.getElementById('user-avatar').textContent = appState.currentUser.name.charAt(0).toUpperCase();
            
            // Load user's personal progress
            loadUserProgress();
        }

        function loadUserProgress() {
            const userProgress = appState.currentUser.progress || {};
            const statsDiv = document.getElementById('user-stats');
            
            const totalTests = Object.keys(userProgress).length;
            const totalScore = Object.values(userProgress).reduce((sum, test) => sum + test.score, 0);
            const averageScore = totalTests > 0 ? Math.round(totalScore / totalTests) : 0;
            
            statsDiv.innerHTML = `
                <div style="background: #667eea; color: white; padding: 1.5rem; border-radius: 10px;">
                    <h3>${totalTests}</h3>
                    <p>Tests Completed</p>
                </div>
                <div style="background: #00bcd4; color: white; padding: 1.5rem; border-radius: 10px;">
                    <h3>${averageScore}%</h3>
                    <p>Average Score</p>
                </div>
                <div style="background: #4caf50; color: white; padding: 1.5rem; border-radius: 10px;">
                    <h3>#${Math.floor(Math.random() * 100) + 1}</h3>
                    <p>Rank</p>
                </div>
            `;
            
            // Load progress details
            const progressDiv = document.getElementById('progress-stats');
            if (totalTests > 0) {
                progressDiv.innerHTML = Object.entries(userProgress).slice(0, 5).map(([testId, test]) => `
                    <div style="margin-bottom: 0.5rem; padding: 10px; background: #f5f5f5; border-radius: 5px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>Test ${testId}</span>
                            <span style="font-weight: bold; color: ${test.score >= 70 ? '#4caf50' : '#f44336'}">
                                ${test.score}%
                            </span>
                        </div>
                    </div>
                `).join('');
            } else {
                progressDiv.innerHTML = '<p style="color: #666;">No tests completed yet</p>';
            }
        }

        // ========== TESTS PAGE ==========
        function loadTestsPage() {
            const container = document.getElementById('tests-container');
            
            const tests = [
                { id: 1, title: "Biology Test 1", subject: "biology", difficulty: "Easy", questions: 10 },
                { id: 2, title: "Biology Test 2", subject: "biology", difficulty: "Medium", questions: 10 },
                { id: 3, title: "Chemistry Test 1", subject: "chemistry", difficulty: "Easy", questions: 10 },
                { id: 4, title: "Chemistry Test 2", subject: "chemistry", difficulty: "Medium", questions: 10 },
                { id: 5, title: "Physics Test 1", subject: "physics", difficulty: "Medium", questions: 10 },
                { id: 6, title: "Physics Test 2", subject: "physics", difficulty: "Hard", questions: 10 },
                { id: 7, title: "English Test 1", subject: "english", difficulty: "Easy", questions: 10 },
                { id: 8, title: "English Test 2", subject: "english", difficulty: "Medium", questions: 10 }
            ];
            
            container.innerHTML = tests.map(test => {
                const userProgress = appState.currentUser?.progress || {};
                const testResult = userProgress[test.id];
                
                return `
                    <div class="test-card" onclick="startTest(${test.id}, '${test.subject}')">
                        <h3>${test.title}</h3>
                        <p style="color: #666; margin: 10px 0;">
                            <span style="background: ${getSubjectColor(test.subject)}; color: white; padding: 3px 10px; border-radius: 15px; font-size: 0.9rem;">
                                ${test.subject.toUpperCase()}
                            </span>
                            <span style="margin-left: 10px;">${test.questions} Questions</span>
                        </p>
                        <p>Difficulty: <strong>${test.difficulty}</strong></p>
                        ${testResult ? `
                            <div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid #eee;">
                                <p style="color: ${testResult.score >= 70 ? '#4caf50' : '#f44336'}; font-weight: bold;">
                                    Score: ${testResult.score}%
                                </p>
                            </div>
                        ` : `
                            <button class="btn btn-primary" style="margin-top: 15px;" onclick="event.stopPropagation(); startTest(${test.id}, '${test.subject}')">
                                Start Test
                            </button>
                        `}
                    </div>
                `;
            }).join('');
            
            // Reset filters
            document.querySelectorAll('#tests-page .btn').forEach(btn => {
                btn.style.background = '';
                btn.style.color = '';
            });
            document.getElementById('filter-all').style.background = '#667eea';
            document.getElementById('filter-all').style.color = 'white';
        }

        function filterTests(subject) {
            const tests = document.querySelectorAll('.test-card');
            const filterBtns = document.querySelectorAll('#tests-page .btn');
            
            // Update button styles
            filterBtns.forEach(btn => {
                btn.style.background = '';
                btn.style.color = '';
            });
            event.target.style.background = '#667eea';
            event.target.style.color = 'white';
            
            // Filter tests
            tests.forEach(test => {
                if (subject === 'all' || test.textContent.toLowerCase().includes(subject)) {
                    test.style.display = 'block';
                } else {
                    test.style.display = 'none';
                }
            });
        }

        function getSubjectColor(subject) {
            const colors = {
                biology: '#4caf50',
                chemistry: '#2196f3',
                physics: '#ff9800',
                english: '#9c27b0'
            };
            return colors[subject] || '#667eea';
        }

        // ========== QUIZ FUNCTIONS ==========
        function startTest(testId, subject) {
            if (!appState.isLoggedIn) {
                showPage('login');
                return;
            }
            
            appState.currentTest = { id: testId, subject: subject };
            appState.currentQuestion = 0;
            appState.userAnswers = [];
            
            // Load first question
            loadQuestion();
            showPage('quiz');
        }

        function loadQuestion() {
            const container = document.getElementById('quiz-content');
            const subject = appState.currentTest.subject;
            const questions = testQuestions[subject];
            
            if (!questions || appState.currentQuestion >= questions.length) {
                finishTest();
                return;
            }
            
            const question = questions[appState.currentQuestion];
            
            container.innerHTML = `
                <div style="background: white; padding: 2rem; border-radius: 10px;">
                    <h2 style="margin-bottom: 2rem;">${appState.currentTest.subject.toUpperCase()} Test</h2>
                    
                    <div style="margin-bottom: 2rem;">
                        <h3>Question ${appState.currentQuestion + 1} of ${questions.length}</h3>
                        <p style="font-size: 1.2rem; margin: 1rem 0;">${question.question}</p>
                    </div>
                    
                    <div style="display: grid; gap: 1rem;">
                        ${question.options.map((option, index) => `
                            <div style="padding: 1rem; border: 2px solid #ddd; border-radius: 8px; cursor: pointer; 
                                 ${appState.userAnswers[appState.currentQuestion] === index ? 'background: #e3f2fd; border-color: #2196f3;' : ''}"
                                 onclick="selectAnswer(${index})">
                                ${String.fromCharCode(65 + index)}. ${option}
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="margin-top: 2rem; display: flex; justify-content: space-between;">
                        <button class="btn" onclick="prevQuestion()" ${appState.currentQuestion === 0 ? 'disabled' : ''}>
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextQuestion()">
                            ${appState.currentQuestion === questions.length - 1 ? 'Finish Test' : 'Next Question'} 
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            `;
        }

        function selectAnswer(answerIndex) {
            appState.userAnswers[appState.currentQuestion] = answerIndex;
            loadQuestion();
        }

        function prevQuestion() {
            if (appState.currentQuestion > 0) {
                appState.currentQuestion--;
                loadQuestion();
            }
        }

        function nextQuestion() {
            const subject = appState.currentTest.subject;
            const questions = testQuestions[subject];
            
            if (appState.currentQuestion < questions.length - 1) {
                appState.currentQuestion++;
                loadQuestion();
            } else {
                finishTest();
            }
        }

        function finishTest() {
            const subject = appState.currentTest.subject;
            const questions = testQuestions[subject];
            let correct = 0;
            
            // Calculate score
            questions.forEach((q, index) => {
                if (appState.userAnswers[index] === q.correct) {
                    correct++;
                }
            });
            
            const score = Math.round((correct / questions.length) * 100);
            
            // Save to user's progress
            if (appState.currentUser) {
                if (!appState.currentUser.progress) {
                    appState.currentUser.progress = {};
                }
                
                appState.currentUser.progress[appState.currentTest.id] = {
                    score: score,
                    correct: correct,
                    total: questions.length,
                    subject: subject,
                    date: new Date().toISOString()
                };
                
                // Update in users array
                const userIndex = appState.users.findIndex(u => u.id === appState.currentUser.id);
                if (userIndex !== -1) {
                    appState.users[userIndex] = appState.currentUser;
                    localStorage.setItem('mdcatUsers', JSON.stringify(appState.users));
                    localStorage.setItem('currentUser', JSON.stringify(appState.currentUser));
                }
            }
            
            // Show results
            const container = document.getElementById('quiz-content');
            container.innerHTML = `
                <div style="background: white; padding: 3rem; border-radius: 10px; text-align: center;">
                    <h2>Test Completed!</h2>
                    <div style="width: 150px; height: 150px; margin: 2rem auto; 
                         background: ${score >= 70 ? '#4caf50' : '#f44336'}; 
                         color: white; border-radius: 50%; display: flex; 
                         align-items: center; justify-content: center; font-size: 3rem; font-weight: bold;">
                        ${score}%
                    </div>
                    <p>You scored ${correct} out of ${questions.length} questions</p>
                    <div style="margin-top: 2rem;">
                        <button class="btn btn-primary" onclick="showPage('dashboard')">
                            <i class="fas fa-tachometer-alt"></i> Go to Dashboard
                        </button>
                        <button class="btn" onclick="showPage('tests')" style="margin-left: 1rem;">
                            <i class="fas fa-list"></i> More Tests
                        </button>
                    </div>
                </div>
            `;
        }

        // ========== ADMIN FUNCTIONS ==========
        function loadAdminDashboard() {
            // Update stats
            document.getElementById('total-users').textContent = appState.users.length;
            document.getElementById('online-users').textContent = appState.onlineUsers.length;
            document.getElementById('active-users').textContent = appState.users.length; // For demo
            
            // Load users list
            const usersList = document.getElementById('users-list');
            usersList.innerHTML = appState.map(user => `
                <div style="padding: 1rem; border-bottom: 1px solid #eee; display: flex; align-items: center; gap: 1rem;">
                    <div style="width: 40px; height: 40px; background: #667eea; color: white; 
                         border-radius: 50%; display: flex; align-items: center; justify-content: center; 
                         font-weight: bold;">
                        ${user.name.charAt(0).toUpperCase()}
                    </div>
                    <div style="flex: 1;">
                        <div style="font-weight: bold;">${user.name}</div>
                        <div style="color: #666; font-size: 0.9rem;">${user.email}</div>
                    </div>
                    <div>
                        <span style="background: ${user.role === 'admin' ? '#f44336' : '#4caf50'}; 
                              color: white; padding: 3px 10px; border-radius: 15px; font-size: 0.8rem;">
                            ${user.role}
                        </span>
                    </div>
                </div>
            `).join('');
        }

        // ========== MOBILE MENU ==========
        function toggleMobileMenu() {
            const navLinks = document.querySelector('.nav-links');
            const icon = document.querySelector('.mobile-menu-btn i');
            
            if (navLinks.style.display === 'flex') {
                navLinks.style.display = 'none';
                icon.className = 'fas fa-bars';
            } else {
                navLinks.style.display = 'flex';
                navLinks.style.flexDirection = 'column';
                navLinks.style.position = 'absolute';
                navLinks.style.top = '100%';
                navLinks.style.left = '0';
                navLinks.style.right = '0';
                navLinks.style.background = 'white';
                navLinks.style.padding = '2rem';
                navLinks.style.boxShadow = 'var(--shadow)';
                icon.className = 'fas fa-times';
            }
        }

        // ========== BOOK UPLOAD ==========
        function uploadBook() {
            // This would handle file upload in real app
            const book = {
                title: "Chemistry Textbook",
                subject: "chemistry",
                thumbnail: "https://via.placeholder.com/200x300/2196f3/ffffff?text=Chemistry+Book",
                link: "#",
                uploadedBy: appState.currentUser?.name || "Admin"
            };
            
            alert(`Book "${book.title}" uploaded successfully!\nThumbnail added: ${book.thumbnail}`);
        }

        // Logout function
        function logout() {
            // Remove from online users
            if (appState.currentUser) {
                const index = appState.onlineUsers.indexOf(appState.currentUser.id);
                if (index > -1) {
                    appState.onlineUsers.splice(index, 1);
                }
            }
            
            appState.currentUser = null;
            appState.isLoggedIn = false;
            appState.isAdmin = false;
            
            localStorage.removeItem('currentUser');
            showPage('home');
            alert('Logged out successfully');
        }
    </script>
</body>
</html>
